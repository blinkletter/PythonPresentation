

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Part 3E: Bootstrapping Confidence Intervals &#8212; Python Presentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/tufte.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '03E-Eyring_Exercises_5_Bootstrap';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Part 4: Styling with Style Sheets" href="04-Styling.html" />
    <link rel="prev" title="Part 3D: Reading Data" href="03D-Eyring_Exercises_4_pandas.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="start.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/Ouroboros-benzene.svg.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/Ouroboros-benzene.svg.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="start.html">
                    Documenting Data Analysis
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_PlotBasics.html">Part 1: Quick Examples of Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="02-CubicSpline.html">Part 2: Please Don’t Use “Smooth Lines”</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Curve Fits and Error</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="03-Eyring_Exercises_Intro.html">The Erying Equation and Experimental Error</a></li>
<li class="toctree-l1"><a class="reference internal" href="03A-Eyring_Exercises_1_simple.html">Part 3A: A Simple Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="03B-Eyring_Exercises_2_curvefit.html">Part 3B: Curve Fitting and Covariance</a></li>
<li class="toctree-l1"><a class="reference internal" href="03C-Eyring_Exercises_3_LMfit.html">Part 3C: Using LMFit</a></li>
<li class="toctree-l1"><a class="reference internal" href="03D-Eyring_Exercises_4_pandas.html">Part 3D: Reading Data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Part 3E: Bootstrapping Confidence Intervals</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Style</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="04-Styling.html">Part 4: Styling with Style Sheets</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/blinkletter/PythonPresentation/blob/main/./03E-Eyring_Exercises_5_Bootstrap.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/03E-Eyring_Exercises_5_Bootstrap.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Part 3E: Bootstrapping Confidence Intervals</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-data-set">The Data Set</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-quick-bootstrap">A Quick Bootstrap</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#styling-the-plot">Styling the Plot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-bootstrap">The Bootstrap</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-bootstrap-runs">Plotting the Bootstrap Runs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-the-distribution">Checking the Distribution</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smooth-bootstrap">Smooth Bootstrap</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-the-smoothness">Checking the Smoothness</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-a-confidence-band">Plotting a Confidence Band</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-gaussian-error">Bonus: Gaussian Error</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-bootstrap-step-by-step">Bonus: Bootstrap Step by Step</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="tex2jax_ignore mathjax_ignore section" id="part-3e-bootstrapping-confidence-intervals">
<h1>Part 3E: Bootstrapping Confidence Intervals<a class="headerlink" href="#part-3e-bootstrapping-confidence-intervals" title="Permalink to this headline">#</a></h1>
<p>The confidence intervals calculated with the uncertain fit parameters determined using <code class="docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit</span></code> or <code class="docutils literal notranslate"><span class="pre">lmfit.fit</span></code> are symmetrical. We get <span class="math notranslate nohighlight">\(\pm\)</span> some value as the standard deviation. This is a perfectly good was to estimate the confidence interval (all errors are estimated) but it hides a subtle truth. The confidence is not symmetrical. The data does not necesssarity have the same contribution to each parameter across the range of measuremnts and some regions may have more error than others, especially with non-linear curve fits.</p>
<p>One way to estimate a confidence interval that reflects these regional effects in your data series is to use bootstrapping. It is a computationally expensive method where we randomly select data points from our data set and perfomr the curve fit hundreds, perhaps thousands of times. Then we values for the parameters that encompass the 68%, 95% and 99% percentiles (<span class="math notranslate nohighlight">\(1\sigma\)</span>, <span class="math notranslate nohighlight">\(2\sigma\)</span>, <span class="math notranslate nohighlight">\(3\sigma\)</span>) or any arbitrary range we like. The median values and these upper and lower bounds will reflect a more accurate picture of estimated error, if we have enough data.</p>
<p>This method may not be useful with small data sets as there may not be enough combinations such that percentiles are meaningful. Choosing the 95% percentile range from 6 discrete values is not useful. However, there are ways to magnify the amount of data through applying random error to data points. Is that appropriate? Some say yes, some say no. Regardless, you will know exactly what I did to determine the confidence interval for my experiment because the code is available for your inspection.</p>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">#</a></h2>
<p>As before, we load in the <em>Python</em> packages needed and set global variables.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Install and load packages</span>

<span class="c1">#!pip install uncertainties              # uncomment to install dependancy</span>

<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>     <span class="c1"># tool for curve fitting</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">linregress</span>     <span class="c1"># tool for curve fitting</span>
<span class="kn">import</span> <span class="nn">scipy</span>                             <span class="c1"># includes tools for data analysis</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>                       <span class="c1"># import the tools of NumPy but use a shorter name, &quot;np&quot;</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>     <span class="c1"># tools for plotting</span>

<span class="kn">import</span> <span class="nn">uncertainties</span> <span class="k">as</span> <span class="nn">un</span>               <span class="c1"># tool set for handling numbers with uncertainties</span>
<span class="kn">from</span> <span class="nn">uncertainties</span> <span class="kn">import</span> <span class="n">unumpy</span> <span class="k">as</span> <span class="n">unp</span>  <span class="c1"># a replacement for numpy that uses uncertainty values</span>

<span class="c1">### Set global variables</span>

<span class="n">location_data</span> <span class="o">=</span> <span class="s2">&quot;data/&quot;</span>         <span class="c1">## Use either local folder or github folder. </span>
<span class="n">location_styles</span> <span class="o">=</span> <span class="s2">&quot;styles/&quot;</span>     <span class="c1">## Use github locations for Colab</span>
<span class="c1">#location_data = &quot;https://raw.githubusercontent.com/blinkletter/PythonPresentation/main/data/&quot;</span>
<span class="c1">#location_styles = &quot;https://raw.githubusercontent.com/blinkletter/PythonPresentation/main/styles/&quot;</span>
</pre></div>
</div>
</div>
</details>
</div>
</div>
<div class="section" id="the-data-set">
<h2>The Data Set<a class="headerlink" href="#the-data-set" title="Permalink to this headline">#</a></h2>
<p>We will begin with the 5-point data set that we have been using so far.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span>     <span class="p">[</span><span class="mi">293</span><span class="p">,</span> <span class="mi">298</span><span class="p">,</span>  <span class="mi">303</span><span class="p">,</span>  <span class="mi">308</span><span class="p">,</span>  <span class="mi">313</span><span class="p">]</span>       <span class="c1"># list of temperatures</span>
<span class="n">k_obs</span> <span class="o">=</span>    <span class="p">[</span><span class="mf">7.6</span><span class="p">,</span> <span class="mf">11.7</span><span class="p">,</span> <span class="mf">15.2</span><span class="p">,</span> <span class="mf">21.3</span><span class="p">,</span> <span class="mf">27.8</span><span class="p">]</span>      <span class="c1"># list of observe rate constants (s^-1)</span>
<span class="n">k_obs_err</span><span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">,</span>  <span class="mf">0.9</span><span class="p">,</span>  <span class="mf">0.9</span><span class="p">]</span>       <span class="c1"># list of standard deviations for data</span>

<span class="c1">### Convert lists to numpy arrays (enables numpy math tools with these lists)</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>              <span class="c1"># an array of float values</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">uarray</span><span class="p">(</span><span class="n">k_obs</span><span class="p">,</span> <span class="n">k_obs_err</span><span class="p">)</span>   <span class="c1"># make an array of ufloat values</span>

<span class="c1">### Calculate x, y values and the uncertainty y_err using the</span>
<span class="c1">###   error propagation provided by the *uncertainties* package</span>

<span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">temp</span>                         <span class="c1"># 1/T</span>
<span class="n">y_u</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">temp</span><span class="p">)</span>              <span class="c1"># ln(k/T) uncertain array for y-axis</span>

<span class="c1">### Separate the uncertain y value into y and y_err for use in the curve_fit function</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">y_u</span><span class="p">)</span>        <span class="c1"># extract arrays of nominal values and errors</span>
<span class="n">y_err</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">std_devs</span><span class="p">(</span><span class="n">y_u</span><span class="p">)</span>          <span class="c1">#   because curve_fit can&#39;t handle ufloats</span>

<span class="c1">#display(x, k, y_u)</span>
</pre></div>
</div>
</div>
</details>
</div>
</div>
<div class="section" id="a-quick-bootstrap">
<h2>A Quick Bootstrap<a class="headerlink" href="#a-quick-bootstrap" title="Permalink to this headline">#</a></h2>
<p>We can get a bootstrapped confidence interval using the <code class="docutils literal notranslate"><span class="pre">seaborn.regplot()</span></code> function that is part of the <em>Seaborn</em> plotting package. It will perform a bootstrap analysis and plot the confidence interval requested (below I am using a stardard 95% confiodence interval. Change the confidence and see what happens.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>

<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">ci</span> <span class="o">=</span> <span class="mf">95.7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/245393801be830bcd979bd2279b15f39a4418ad2ffa7c780b85e9ca85acaf8c0.png" src="_images/245393801be830bcd979bd2279b15f39a4418ad2ffa7c780b85e9ca85acaf8c0.png" />
</div>
</div>
<div class="section" id="styling-the-plot">
<h3>Styling the Plot<a class="headerlink" href="#styling-the-plot" title="Permalink to this headline">#</a></h3>
<p>Below is the same plot as above but I have added styling to the plot to fit with my own preferred publication style. We can send plotting style parameters into the <code class="docutils literal notranslate"><span class="pre">regplot()</span></code> function using keyword dictionaries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
            <span class="n">scatter_kws</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;facecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="s2">&quot;edgecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;linewidths&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;zorder&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">},</span>
            <span class="n">line_kws</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;zorder&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span> 
            <span class="n">ci</span> <span class="o">=</span> <span class="mf">95.5</span><span class="p">,</span> <span class="c1"># sigma = 2</span>
            <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mf">0.0032</span><span class="p">,</span><span class="mf">0.0033</span><span class="p">,</span><span class="mf">0.0034</span><span class="p">])</span>   <span class="c1"># Set values to display on x-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;${1/T}$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\ln{k/T}$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Seaborn RegPlot&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/seaborn2.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5e190cdcc528541e3e614f03311197d7c0377fd142be8c93c46df84c16ba6221.png" src="_images/5e190cdcc528541e3e614f03311197d7c0377fd142be8c93c46df84c16ba6221.png" />
</div>
</div>
</div>
</div>
<div class="section" id="the-bootstrap">
<h2>The Bootstrap<a class="headerlink" href="#the-bootstrap" title="Permalink to this headline">#</a></h2>
<p>The code below will sample points from the data with replacement. That means that in a list of 1-2-3-4-5 we might sample 1-3-4-1-2. Note that we might have two or three points repeated (or even, in rare instances, all five being the same selected point). We curve fit the resampled data and collect the slope, intercept, calculated <span class="math notranslate nohighlight">\(\Delta H^\ddagger\)</span> &amp; <span class="math notranslate nohighlight">\(\Delta S^\ddagger\)</span> values in lists. We also calculate the predicted lines based on the curve fit in each case and store the predicted values in lists as well.</p>
<p>After we run the analysis many times (2000 times in the example below) we can select the values that border the confidence interval in each list. If we are interested in 68% confidence (one standard deviation or <span class="math notranslate nohighlight">\(1\sigma\)</span>) then we select the value at the <span class="math notranslate nohighlight">\(16^{th}\)</span> percentile (lower limit of confidence) and the value at the <span class="math notranslate nohighlight">\(84^{th}\)</span> percentile (a span of <span class="math notranslate nohighlight">\(34\%\)</span> on either side of the median, a band than contains the central <span class="math notranslate nohighlight">\(68\%\)</span> of the answers.)</p>
<p>We can query the lists of line fit and calculated thermodynamic parameters and get the range that encloses the middle <span class="math notranslate nohighlight">\(68\%\)</span> of the possible results. How does this compare to the traditional line fit and calculated standard deviation? Note that the upper and lower limits are not symmetrical around the mean value. the bootstrap reveals a more “real world” confidence interval, and yet it is not greatly different that the standard deviation determined using a standard curve fit.</p>
<p>Observe that when you run the bootstrap process again, the values change slightly. Each run is a different set of random resamplings. In a system where we have few data points we end up with sets of repeating lines. This can result in jumps in the percentile values depending on hoe many times these lines repeat. The bootstrap is a poor choice for limited data sets, however this can be addressed as we soon shall see.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">################################################################################</span>
<span class="c1">### BOOTSTRAP </span>
<span class="c1">### </span>
<span class="c1">### Adapted from code found in https://stats.stackexchange.com/questions/183230/bootstrapping-confidence-interval-from-a-regression-prediction</span>
<span class="c1">################################################################################</span>

<span class="c1">#######################################</span>
<span class="c1">## Global variables</span>
<span class="c1">#######################################</span>

<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>                 <span class="c1"># Confidence. 1 sigma:68%, 2 sigma:95%, 3 sigma:99$</span>
<span class="n">boot_n</span> <span class="o">=</span> <span class="mi">2000</span>             <span class="c1"># Number of bootstrap resamples</span>

<span class="c1">#######################################</span>
<span class="c1">## Define confidence percentile limits</span>
<span class="c1">#######################################</span>

<span class="n">sigma_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mf">68.3</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mf">95.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mf">99.7</span><span class="p">}</span>      

<span class="n">conf</span> <span class="o">=</span> <span class="n">sigma_dict</span><span class="p">[</span><span class="n">sigma</span><span class="p">]</span>
<span class="n">low_p</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">-</span> <span class="n">conf</span><span class="o">/</span><span class="mi">2</span>
<span class="n">high_p</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">+</span> <span class="n">conf</span><span class="o">/</span><span class="mi">2</span>

<span class="c1">#######################################</span>
<span class="c1">## Set up functions for curve fit and thermodynamic calculations</span>
<span class="c1">#######################################</span>

<span class="k">def</span> <span class="nf">linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">):</span>     <span class="c1"># Linear function for line fitting</span>
    <span class="k">return</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">intercept</span>

<span class="k">def</span> <span class="nf">eyring_calc</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">):</span>   <span class="c1"># Calculate thermodynamic parameters</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">R</span>
    <span class="n">kb</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">k</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">h</span>
    <span class="n">kappa</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="n">dH</span> <span class="o">=</span> <span class="o">-</span><span class="n">slope</span> <span class="o">*</span> <span class="n">R</span>
    <span class="n">dS</span> <span class="o">=</span> <span class="p">(</span><span class="n">intercept</span> <span class="o">-</span> <span class="n">unp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">kb</span><span class="o">/</span><span class="n">h</span><span class="p">))</span> <span class="o">*</span> <span class="n">R</span>
    <span class="k">return</span> <span class="n">dH</span><span class="p">,</span> <span class="n">dS</span>

<span class="c1">#######################################</span>
<span class="c1">## Bootstrap - Calculate a list of line fits for resampled data sets.</span>
<span class="c1">#######################################</span>

<span class="n">slope_list</span> <span class="o">=</span> <span class="p">[]</span>               <span class="c1"># A list of slopes from each iteration of bootstrap</span>
<span class="n">intercept_list</span> <span class="o">=</span> <span class="p">[]</span>           <span class="c1"># A list of intercepts</span>

<span class="n">dS_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dH_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">x_for_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>   <span class="c1"># Array of x values </span>
<span class="n">x0_for_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>          <span class="c1"># Array of x values starting at zero</span>

<span class="n">y_list</span> <span class="o">=</span> <span class="p">[]</span>                   <span class="c1"># A list of predicted values at each data point</span>
<span class="n">y_for_ci</span> <span class="o">=</span> <span class="p">[]</span>                 <span class="c1"># A list of sets of predicted values at each x point                     </span>
<span class="n">y0_for_ci</span> <span class="o">=</span> <span class="p">[]</span>                <span class="c1"># A list of sets of predicted values at each x0 point</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boot_n</span><span class="p">):</span>
    <span class="n">pick</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>     <span class="c1"># Random list of data points to pick</span>

    <span class="n">x_s</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">pick</span><span class="p">]</span>             <span class="c1"># Get x and y values from random pick</span>
    <span class="n">y_s</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">pick</span><span class="p">]</span> 
    <span class="n">y_err_s</span> <span class="o">=</span> <span class="n">y_err</span><span class="p">[</span><span class="n">pick</span><span class="p">]</span>

    <span class="n">popt</span><span class="p">,</span><span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">linear</span><span class="p">,</span> <span class="n">x_s</span><span class="p">,</span> <span class="n">y_s</span><span class="p">,</span>     <span class="c1"># Curve fit the resampled data</span>
<span class="c1">#                          sigma = y_err        # Should we include weights?</span>
                          <span class="p">)</span>    
    <span class="p">[</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">]</span> <span class="o">=</span> <span class="n">popt</span>
    <span class="n">slope_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span>
    <span class="n">intercept_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">intercept</span><span class="p">)</span>

    <span class="n">dH</span><span class="p">,</span> <span class="n">dS</span> <span class="o">=</span> <span class="n">eyring_calc</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">)</span>
    <span class="n">dH_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dH</span><span class="p">)</span>
    <span class="n">dS_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dS</span><span class="p">)</span>

    <span class="n">y_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">))</span>            <span class="c1"># Predict y at data points and add to list</span>
    <span class="n">y_for_ci</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">linear</span><span class="p">(</span><span class="n">x_for_ci</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">))</span>   <span class="c1"># Predict y along data range and add to list</span>
    <span class="n">y0_for_ci</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">linear</span><span class="p">(</span><span class="n">x0_for_ci</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">))</span> <span class="c1"># Predict y from zero to data range and add to list</span>

<span class="c1"># Convert these lists of arrays to arrays of arrays (a matrix)</span>
<span class="n">y_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_list</span><span class="p">)</span>
<span class="n">y_for_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_for_ci</span><span class="p">)</span>    
<span class="n">y0_for_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y0_for_ci</span><span class="p">)</span>

<span class="c1">### Package up data into a dictionary object (for convenience)</span>

<span class="n">bs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;y_list&quot;</span><span class="p">:</span> <span class="n">y_list</span><span class="p">,</span>
    <span class="s2">&quot;x_for_ci&quot;</span><span class="p">:</span> <span class="n">x_for_ci</span><span class="p">,</span>
    <span class="s2">&quot;y_for_ci&quot;</span><span class="p">:</span> <span class="n">y_for_ci</span><span class="p">,</span>
    <span class="s2">&quot;x0_for_ci&quot;</span><span class="p">:</span> <span class="n">x0_for_ci</span><span class="p">,</span>
    <span class="s2">&quot;y0_for_ci&quot;</span><span class="p">:</span> <span class="n">y0_for_ci</span><span class="p">,</span>
    <span class="s2">&quot;slope_list&quot;</span><span class="p">:</span> <span class="n">slope_list</span><span class="p">,</span>
    <span class="s2">&quot;intercept_list&quot;</span><span class="p">:</span> <span class="n">intercept_list</span><span class="p">,</span>
    <span class="s2">&quot;dH_list&quot;</span><span class="p">:</span> <span class="n">dH_list</span><span class="p">,</span>
    <span class="s2">&quot;dS_list&quot;</span><span class="p">:</span> <span class="n">dS_list</span>
<span class="p">}</span>

<span class="c1">#######################################</span>
<span class="c1">## Traditional Curve Fit for Comparison</span>
<span class="c1">#######################################</span>

<span class="n">popt</span><span class="p">,</span><span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">linear</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>                        <span class="c1"># Final curve fit of original data</span>
<span class="c1">#                      sigma = y_err, absolute_sigma=False  # Include st_devs for y data in calculations</span>
                     <span class="p">)</span>

<span class="c1"># Create new ufloat objects from returned parameters and covariance matrix results</span>
<span class="p">[</span><span class="n">slope_u</span><span class="p">,</span> <span class="n">intercept_u</span><span class="p">]</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">correlated_values</span><span class="p">(</span><span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span><span class="p">)</span>

<span class="c1">#######################################</span>
<span class="c1">### Report</span>
<span class="c1">#######################################</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confidence level = </span><span class="si">{</span><span class="n">conf</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">numbers</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="s2">&quot;slope_list&quot;</span><span class="p">])</span>
<span class="n">top_slope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">high_p</span><span class="p">)</span>
<span class="n">bot_slope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">low_p</span><span class="p">)</span>
<span class="n">median_slope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;slope range is </span><span class="si">{</span><span class="n">top_slope</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">bot_slope</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median slope in bootstrap population is </span><span class="si">{</span><span class="n">median_slope</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">top_slope</span><span class="o">-</span><span class="n">median_slope</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">median_slope</span><span class="o">-</span><span class="n">bot_slope</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;best fit value for slope is </span><span class="si">{</span><span class="n">slope_u</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">numbers</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="s2">&quot;intercept_list&quot;</span><span class="p">])</span>
<span class="n">top_intercept</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">high_p</span><span class="p">)</span>
<span class="n">bot_intercept</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">low_p</span><span class="p">)</span>
<span class="n">median_intercept</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;intercept range is </span><span class="si">{</span><span class="n">top_intercept</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">bot_intercept</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median intercept in bootstrap population is </span><span class="si">{</span><span class="n">median_intercept</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">top_intercept</span><span class="o">-</span><span class="n">median_intercept</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">median_intercept</span><span class="o">-</span><span class="n">bot_intercept</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;best fit value for intercept is </span><span class="si">{</span><span class="n">intercept_u</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">dH</span><span class="p">,</span> <span class="n">dS</span> <span class="o">=</span> <span class="n">eyring_calc</span><span class="p">(</span><span class="n">slope_u</span><span class="p">,</span> <span class="n">intercept_u</span><span class="p">)</span>

<span class="n">numbers</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="s2">&quot;dH_list&quot;</span><span class="p">])</span>
<span class="n">top_dH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">high_p</span><span class="p">)</span>
<span class="n">bot_dH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">low_p</span><span class="p">)</span>
<span class="n">median_dH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;delta H range is </span><span class="si">{</span><span class="n">bot_dH</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">top_dH</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median delta H in bootstrap population is </span><span class="si">{</span><span class="n">median_dH</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">top_dH</span><span class="o">-</span><span class="n">median_dH</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">median_dH</span><span class="o">-</span><span class="n">bot_dH</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;best fit value for delta H is </span><span class="si">{</span><span class="n">dH</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">numbers</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="s2">&quot;dS_list&quot;</span><span class="p">])</span>
<span class="n">top_dS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">high_p</span><span class="p">)</span>
<span class="n">bot_dS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">low_p</span><span class="p">)</span>
<span class="n">median_dS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;delta S range is </span><span class="si">{</span><span class="n">bot_dS</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">top_dS</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median delta S in bootstrap population is </span><span class="si">{</span><span class="n">median_dS</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">top_dS</span><span class="o">-</span><span class="n">median_dS</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">median_dS</span><span class="o">-</span><span class="n">bot_dS</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;best fit value for delta S is </span><span class="si">{</span><span class="n">dS</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">bs_simple</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/3h/d_p2gtjd78g8c7m6c14chsg00000gq/T/ipykernel_41161/37414098.py:65: OptimizeWarning: Covariance of the parameters could not be estimated
  popt,pcov = curve_fit(linear, x_s, y_s,     # Curve fit the resampled data
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Confidence level = 68.3%

slope range is -5161.6 to -5852.7
median slope in bootstrap population is -5579.6 + 418.0 - 273.0
best fit value for slope is -5560.1+/-249.1

intercept range is 16.33 to 14.07
median intercept in bootstrap population is 15.43 + 0.90 - 1.36
best fit value for intercept is 15.37+/-0.82

delta H range is 42916.27 to 48661.72
median delta H in bootstrap population is 46391.72 + 2270.01 - 3475.45
best fit value for delta H is 46229.03+/-2070.94

delta S range is -80.56 to -61.75
median delta S in bootstrap population is -69.22 + 7.48 - 11.34
best fit value for delta S is -69.80+/-6.84
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plotting-the-bootstrap-runs">
<h2>Plotting the Bootstrap Runs<a class="headerlink" href="#plotting-the-bootstrap-runs" title="Permalink to this headline">#</a></h2>
<p>Let us plot all the curve fits fom the bootstrap. Thats 2000 lines on a plot. I will use transparent lines (5% visible or alpha = 0.05) so that only the areas of the plot with many lines will “stack up” and be visible. The code below will plot the bootstrap data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################</span>
<span class="c1">### Create plot</span>
<span class="c1">#######################################</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="c1">#style = &quot;S2_classic2.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="n">size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>  

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
<span class="c1">#          title = Title,       </span>
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\ln (k / T)$&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$1/T$&quot;</span><span class="p">,</span>                
<span class="c1">#          xlim=[0.0030,0.00354],                  </span>
<span class="c1">#          ylim=[-4.5,-1.1]</span>
       <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mf">0.0031</span><span class="p">,</span><span class="mf">0.0033</span><span class="p">,</span><span class="mf">0.0035</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
<span class="c1">#          title = Title,       </span>
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\ln (k / T)$&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$1/T$&quot;</span><span class="p">,</span>                
          <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0036</span><span class="p">],</span>                  
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">18</span><span class="p">]</span>
       <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">0.002</span><span class="p">,</span><span class="mf">0.003</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
              <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
              <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">y_err</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">,</span> 
               <span class="n">ecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> 
            <span class="c1">#   capsize=2, capthick=0.5, </span>
               <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">bs</span><span class="p">[</span><span class="s2">&quot;y_for_ci&quot;</span><span class="p">]:</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="s2">&quot;x_for_ci&quot;</span><span class="p">],</span> <span class="n">line</span><span class="p">,</span> 
               <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">bs</span><span class="p">[</span><span class="s2">&quot;y0_for_ci&quot;</span><span class="p">]:</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="s2">&quot;x0_for_ci&quot;</span><span class="p">],</span> <span class="n">line</span><span class="p">,</span> 
               <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#######################################</span>
<span class="c1">### Plot Best Fit</span>
<span class="c1">#######################################</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="s2">&quot;x_for_ci&quot;</span><span class="p">],</span> <span class="n">linear</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="s2">&quot;x_for_ci&quot;</span><span class="p">],</span> <span class="n">slope_u</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">intercept_u</span><span class="o">.</span><span class="n">n</span><span class="p">),</span> 
           <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="s2">&quot;x0_for_ci&quot;</span><span class="p">],</span> <span class="n">linear</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="s2">&quot;x0_for_ci&quot;</span><span class="p">],</span> <span class="n">slope_u</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">intercept_u</span><span class="o">.</span><span class="n">n</span><span class="p">),</span> 
           <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1">#######################################</span>
<span class="c1">### Output plot</span>
<span class="c1">#######################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/Eyring_bootstrap_1.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fc93edf4eca36711eee9978b7b9a749eab0ec54b137bbf83365414c34a8c6043.png" src="_images/fc93edf4eca36711eee9978b7b9a749eab0ec54b137bbf83365414c34a8c6043.png" />
</div>
</div>
<div class="section" id="checking-the-distribution">
<h3>Checking the Distribution<a class="headerlink" href="#checking-the-distribution" title="Permalink to this headline">#</a></h3>
<p>We can check the quality of our bootstrap process by plotting the values for a give parameter. Let us check the calculated <span class="math notranslate nohighlight">\(\Delta S^\ddagger\)</span> value. We will plot the values and we observe that there are several discrete values that we bounce around between rather than a smooth random. We  will also plot the distribution sorted from lowest values to highest and compare that to a distribution generated by a Gaussian probability curve.</p>
<p>We can see the “steps” that are the result of repeated discrete values. The low number of points means that there are many repeats of the same resample.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">median</span> <span class="o">=</span> <span class="n">median_dS</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">dS</span>
<span class="n">values</span> <span class="o">=</span> <span class="s2">&quot;dS_list&quot;</span>
<span class="n">ylimits</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span><span class="p">]</span>

<span class="n">y1</span> <span class="o">=</span> <span class="n">bs_simple</span><span class="p">[</span><span class="n">values</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">y1_sorted</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">y1</span><span class="p">))</span>


<span class="c1">#######################################</span>
<span class="c1">### Create plot</span>
<span class="c1">#######################################</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="c1">#style = &quot;S2_classic2.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="n">size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>  

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
<span class="c1">#          title = Title,       </span>
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\Delta S^\ddagger$&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$n$&quot;</span><span class="p">,</span>                
<span class="c1">#          xlim=[0.0030,0.00354],                  </span>
          <span class="n">ylim</span><span class="o">=</span><span class="n">ylimits</span>
       <span class="p">)</span>
<span class="c1">#ax[0].set_xticks([0.0031,0.0033,0.0035])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
<span class="c1">#          title = Title,       </span>
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\Delta S^\ddagger$&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\text{sorted }n$&quot;</span><span class="p">,</span>                
<span class="c1">#          xlim=[0, 0.0036],                  </span>
          <span class="n">ylim</span><span class="o">=</span><span class="n">ylimits</span>
       <span class="p">)</span>
<span class="c1">#ax[1].set_xticks([0,0.001,0.002,0.003])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> 
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1_sorted</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">median</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">median</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">#################################################</span>
<span class="c1">### 68%</span>
<span class="n">n_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span>
<span class="n">conf_</span> <span class="o">=</span> <span class="n">sigma_dict</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">percentile68left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="mi">50</span><span class="o">-</span><span class="n">conf_</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">percentile68right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="mi">50</span><span class="o">+</span><span class="n">conf_</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">n_points</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">percentile68left</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">percentile68right</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">percentile68left</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="s2">&quot;68%&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="mi">50</span><span class="o">-</span><span class="n">conf_</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="mi">50</span><span class="o">+</span><span class="n">conf_</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">corners_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">percentile68left</span><span class="p">,</span> <span class="n">percentile68right</span><span class="p">,</span> <span class="n">percentile68right</span><span class="p">,</span> <span class="n">percentile68left</span><span class="p">]</span>
<span class="n">corners_y</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="mi">50</span><span class="o">-</span><span class="n">conf_</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="mi">50</span><span class="o">+</span><span class="n">conf_</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> 
             <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="mi">50</span><span class="o">+</span><span class="n">conf_</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="mi">50</span><span class="o">-</span><span class="n">conf_</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">corners_x</span><span class="p">,</span><span class="n">corners_y</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="c1">### 95%</span>
<span class="n">conf_</span> <span class="o">=</span> <span class="n">sigma_dict</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="n">percentile95left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="mi">50</span><span class="o">-</span><span class="n">conf_</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">percentile95right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="mi">50</span><span class="o">+</span><span class="n">conf_</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">percentile95left</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">percentile95right</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">percentile95left</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="s2">&quot;95%&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="mi">50</span><span class="o">-</span><span class="n">conf_</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="mi">50</span><span class="o">+</span><span class="n">conf_</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>


<span class="c1">#######################################</span>
<span class="c1">### Plot gaussin Dist (Gray line)</span>
<span class="c1">#######################################</span>

<span class="n">y_r_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">x1</span><span class="p">:</span>
<span class="c1">#   y_r = np.random.normal(dS.n, dS.s)   ### smooth with gaussian error </span>
    <span class="n">y_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>   <span class="c1">### smooth with gaussian error </span>
    <span class="n">y_r_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_r</span><span class="p">)</span>

<span class="n">y_r_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y_r_list</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">#######################################</span>
<span class="c1">### Output plot</span>
<span class="c1">#######################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/Eyring_bootstrap_4.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9edab8cf3c84dd2eb849b2e772082dbc59ba9cf98b3557d20d5567fcc4f9a574.png" src="_images/9edab8cf3c84dd2eb849b2e772082dbc59ba9cf98b3557d20d5567fcc4f9a574.png" />
</div>
</div>
</div>
</div>
<div class="section" id="smooth-bootstrap">
<h2>Smooth Bootstrap<a class="headerlink" href="#smooth-bootstrap" title="Permalink to this headline">#</a></h2>
<p>If we do not have a large data set the bootstrap will contain many identical values and a smooth distribution of values will not be possible. However we can create more values by applying error to the data points. The below code is ifdentical to the above except that we are applying a random Gaussian distribution function to each resamples y-value. We will use the standard deviations reported for each data points to define these errors.</p>
<p>Observe how the distribuition of lines is now smoother. There should be a better consistency to the percentile confidence interval values as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">################################################################################</span>
<span class="c1">### SMOOTH BOOTSTRAP </span>
<span class="c1">### </span>
<span class="c1">### Adapted from code found in https://stats.stackexchange.com/questions/183230/bootstrapping-confidence-interval-from-a-regression-prediction</span>
<span class="c1">################################################################################</span>

<span class="c1">#######################################</span>
<span class="c1">## Global variables</span>
<span class="c1">#######################################</span>

<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>                 <span class="c1"># Confidence. 1 sigma:68%, 2 sigma:95%, 3 sigma:99$</span>
<span class="n">boot_n</span> <span class="o">=</span> <span class="mi">2000</span>             <span class="c1"># Number of bootstrap resamples</span>

<span class="c1">#######################################</span>
<span class="c1">## Define confidence percentile limits</span>
<span class="c1">#######################################</span>

<span class="n">sigma_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mf">68.3</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mf">95.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mf">99.7</span><span class="p">}</span>      

<span class="n">conf</span> <span class="o">=</span> <span class="n">sigma_dict</span><span class="p">[</span><span class="n">sigma</span><span class="p">]</span>
<span class="n">low_p</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">-</span> <span class="n">conf</span><span class="o">/</span><span class="mi">2</span>
<span class="n">high_p</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">+</span> <span class="n">conf</span><span class="o">/</span><span class="mi">2</span>

<span class="c1">#######################################</span>
<span class="c1">## Set up functions for curve fit and thermodynamic calculations</span>
<span class="c1">#######################################</span>

<span class="k">def</span> <span class="nf">linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">):</span>     <span class="c1"># Linear function for line fitting</span>
    <span class="k">return</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">intercept</span>

<span class="k">def</span> <span class="nf">eyring_calc</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">):</span>   <span class="c1"># Calculate thermodynamic parameters</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">R</span>
    <span class="n">kb</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">k</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">h</span>
    <span class="n">kappa</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="n">dH</span> <span class="o">=</span> <span class="o">-</span><span class="n">slope</span> <span class="o">*</span> <span class="n">R</span>
    <span class="n">dS</span> <span class="o">=</span> <span class="p">(</span><span class="n">intercept</span> <span class="o">-</span> <span class="n">unp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">kb</span><span class="o">/</span><span class="n">h</span><span class="p">))</span> <span class="o">*</span> <span class="n">R</span>
    <span class="k">return</span> <span class="n">dH</span><span class="p">,</span> <span class="n">dS</span>

<span class="c1">#######################################</span>
<span class="c1">## Bootstrap - Calculate a list of line fits for resampled data sets.</span>
<span class="c1">#######################################</span>

<span class="n">slope_list</span> <span class="o">=</span> <span class="p">[]</span>               <span class="c1"># A list of slopes from each iteration of bootstrap</span>
<span class="n">intercept_list</span> <span class="o">=</span> <span class="p">[]</span>           <span class="c1"># A list of intercepts</span>

<span class="n">dS_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dH_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">x_for_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>   <span class="c1"># Array of x values </span>
<span class="n">x0_for_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>          <span class="c1"># Array of x values starting at zero</span>

<span class="n">y_list</span> <span class="o">=</span> <span class="p">[]</span>                   <span class="c1"># A list of predicted values at each data point</span>
<span class="n">y_for_ci</span> <span class="o">=</span> <span class="p">[]</span>                 <span class="c1"># A list of sets of predicted values at each x point                     </span>
<span class="n">y0_for_ci</span> <span class="o">=</span> <span class="p">[]</span>                <span class="c1"># A list of sets of predicted values at each x0 point</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boot_n</span><span class="p">):</span>
    <span class="n">pick</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>     <span class="c1"># Random list of data points to pick</span>

    <span class="n">x_s</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">pick</span><span class="p">]</span>             <span class="c1"># Get x and y values from random pick</span>
    <span class="n">y_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">pick</span><span class="p">],</span> <span class="n">y_err</span><span class="p">[</span><span class="n">pick</span><span class="p">])</span>   <span class="c1">### smooth with gaussian error </span>
    <span class="n">y_err_s</span> <span class="o">=</span> <span class="n">y_err</span><span class="p">[</span><span class="n">pick</span><span class="p">]</span>

    <span class="n">popt</span><span class="p">,</span><span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">linear</span><span class="p">,</span> <span class="n">x_s</span><span class="p">,</span> <span class="n">y_s</span><span class="p">)</span>    <span class="c1"># Curve fit the resampled data</span>

    <span class="p">[</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">]</span> <span class="o">=</span> <span class="n">popt</span>
    <span class="n">slope_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span>
    <span class="n">intercept_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">intercept</span><span class="p">)</span>

    <span class="n">dH</span><span class="p">,</span> <span class="n">dS</span> <span class="o">=</span> <span class="n">eyring_calc</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">)</span>
    <span class="n">dH_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dH</span><span class="p">)</span>
    <span class="n">dS_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dS</span><span class="p">)</span>

    <span class="n">y_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">))</span>            <span class="c1"># Predict y at data points and add to list</span>
    <span class="n">y_for_ci</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">linear</span><span class="p">(</span><span class="n">x_for_ci</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">))</span>   <span class="c1"># Predict y along data range and add to list</span>
    <span class="n">y0_for_ci</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">linear</span><span class="p">(</span><span class="n">x0_for_ci</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">))</span> <span class="c1"># Predict y from zero to data range and add to list</span>

<span class="c1"># Convert these lists of arrays to arrays of arrays (a matrix)</span>
<span class="n">y_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_list</span><span class="p">)</span>
<span class="n">y_for_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_for_ci</span><span class="p">)</span>    
<span class="n">y0_for_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y0_for_ci</span><span class="p">)</span>

<span class="c1">### Package up data into a dictionary object (for convenience)</span>

<span class="n">bs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;y_list&quot;</span><span class="p">:</span> <span class="n">y_list</span><span class="p">,</span>
    <span class="s2">&quot;x_for_ci&quot;</span><span class="p">:</span> <span class="n">x_for_ci</span><span class="p">,</span>
    <span class="s2">&quot;y_for_ci&quot;</span><span class="p">:</span> <span class="n">y_for_ci</span><span class="p">,</span>
    <span class="s2">&quot;x0_for_ci&quot;</span><span class="p">:</span> <span class="n">x0_for_ci</span><span class="p">,</span>
    <span class="s2">&quot;y0_for_ci&quot;</span><span class="p">:</span> <span class="n">y0_for_ci</span><span class="p">,</span>
    <span class="s2">&quot;slope_list&quot;</span><span class="p">:</span> <span class="n">slope_list</span><span class="p">,</span>
    <span class="s2">&quot;intercept_list&quot;</span><span class="p">:</span> <span class="n">intercept_list</span><span class="p">,</span>
    <span class="s2">&quot;dH_list&quot;</span><span class="p">:</span> <span class="n">dH_list</span><span class="p">,</span>
    <span class="s2">&quot;dS_list&quot;</span><span class="p">:</span> <span class="n">dS_list</span>
<span class="p">}</span>


<span class="c1">#######################################</span>
<span class="c1">## Traditional Curve Fit for Comparison</span>
<span class="c1">#######################################</span>

<span class="n">popt</span><span class="p">,</span><span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">linear</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>                        <span class="c1"># Final curve fit of original data</span>
           <span class="c1">#           sigma = y_err, absolute_sigma=False  # Include st_devs for y data in calculations</span>
                     <span class="p">)</span>

<span class="c1"># Create new ufloat objects from returned parameters and covariance matrix results</span>
<span class="p">[</span><span class="n">slope_u</span><span class="p">,</span> <span class="n">intercept_u</span><span class="p">]</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">correlated_values</span><span class="p">(</span><span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span><span class="p">)</span>

<span class="c1">#######################################</span>
<span class="c1">### Report</span>
<span class="c1">#######################################</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confidence level = </span><span class="si">{</span><span class="n">conf</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">numbers</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="s2">&quot;slope_list&quot;</span><span class="p">])</span>
<span class="n">top_slope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">high_p</span><span class="p">)</span>
<span class="n">bot_slope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">low_p</span><span class="p">)</span>
<span class="n">median_slope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;slope range is </span><span class="si">{</span><span class="n">top_slope</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">bot_slope</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median slope in bootstrap population is </span><span class="si">{</span><span class="n">median_slope</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">top_slope</span><span class="o">-</span><span class="n">median_slope</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">median_slope</span><span class="o">-</span><span class="n">bot_slope</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;best fit value for slope is </span><span class="si">{</span><span class="n">slope_u</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">numbers</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="s2">&quot;intercept_list&quot;</span><span class="p">])</span>
<span class="n">top_intercept</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">high_p</span><span class="p">)</span>
<span class="n">bot_intercept</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">low_p</span><span class="p">)</span>
<span class="n">median_intercept</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;intercept range is </span><span class="si">{</span><span class="n">top_intercept</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">bot_intercept</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median intercept in bootstrap population is </span><span class="si">{</span><span class="n">median_intercept</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">top_intercept</span><span class="o">-</span><span class="n">median_intercept</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">median_intercept</span><span class="o">-</span><span class="n">bot_intercept</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;best fit value for intercept is </span><span class="si">{</span><span class="n">intercept_u</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">dH</span><span class="p">,</span> <span class="n">dS</span> <span class="o">=</span> <span class="n">eyring_calc</span><span class="p">(</span><span class="n">slope_u</span><span class="p">,</span> <span class="n">intercept_u</span><span class="p">)</span>

<span class="n">numbers</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="s2">&quot;dH_list&quot;</span><span class="p">])</span>
<span class="n">top_dH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">high_p</span><span class="p">)</span>
<span class="n">bot_dH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">low_p</span><span class="p">)</span>
<span class="n">median_dH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;delta H range is </span><span class="si">{</span><span class="n">bot_dH</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">top_dH</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median delta H in bootstrap population is </span><span class="si">{</span><span class="n">median_dH</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">top_dH</span><span class="o">-</span><span class="n">median_dH</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">median_dH</span><span class="o">-</span><span class="n">bot_dH</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;best fit value for delta H is </span><span class="si">{</span><span class="n">dH</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">numbers</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="s2">&quot;dS_list&quot;</span><span class="p">])</span>
<span class="n">top_dS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">high_p</span><span class="p">)</span>
<span class="n">bot_dS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">low_p</span><span class="p">)</span>
<span class="n">median_dS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;delta S range is </span><span class="si">{</span><span class="n">bot_dS</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">top_dS</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median delta S in bootstrap population is </span><span class="si">{</span><span class="n">median_dS</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">top_dS</span><span class="o">-</span><span class="n">median_dS</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">median_dS</span><span class="o">-</span><span class="n">bot_dS</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;best fit value for delta S is </span><span class="si">{</span><span class="n">dS</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">bs_smooth</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1">#######################################</span>
<span class="c1">### Create plot</span>
<span class="c1">#######################################</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="c1">#style = &quot;S2_classic2.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="n">size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>  

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
<span class="c1">#          title = Title,       </span>
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\ln (k / T)$&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$1/T$&quot;</span><span class="p">,</span>                
<span class="c1">#          xlim=[0.0030,0.00354],                  </span>
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">4.5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
       <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mf">0.0031</span><span class="p">,</span><span class="mf">0.0033</span><span class="p">,</span><span class="mf">0.0035</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
<span class="c1">#          title = Title,       </span>
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\ln (k / T)$&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$1/T$&quot;</span><span class="p">,</span>                
          <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0036</span><span class="p">],</span>                  
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">18</span><span class="p">]</span>
       <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">0.002</span><span class="p">,</span><span class="mf">0.003</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">y_err</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">,</span> 
               <span class="n">ecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> 
            <span class="c1">#   capsize=2, capthick=0.5, </span>
               <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">y_for_ci</span><span class="p">:</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_for_ci</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> 
               <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">y0_for_ci</span><span class="p">:</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x0_for_ci</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> 
               <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#######################################</span>
<span class="c1">### Plot Best Fit</span>
<span class="c1">#######################################</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_for_ci</span><span class="p">,</span> <span class="n">linear</span><span class="p">(</span><span class="n">x_for_ci</span><span class="p">,</span> <span class="n">slope_u</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">intercept_u</span><span class="o">.</span><span class="n">n</span><span class="p">),</span> 
           <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x0_for_ci</span><span class="p">,</span> <span class="n">linear</span><span class="p">(</span><span class="n">x0_for_ci</span><span class="p">,</span> <span class="n">slope_u</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">intercept_u</span><span class="o">.</span><span class="n">n</span><span class="p">),</span> 
           <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>


<span class="c1">#######################################</span>
<span class="c1">### Output plot</span>
<span class="c1">#######################################</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/Eyring_bootstrap_2.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Confidence level = 68.3%

slope range is -5150.0 to -5884.8
median slope in bootstrap population is -5574.3 + 424.3 - 310.5
best fit value for slope is -5560.1+/-249.1

intercept range is 16.44 to 14.03
median intercept in bootstrap population is 15.41 + 1.03 - 1.38
best fit value for intercept is 15.37+/-0.82

delta H range is 42819.12 to 48929.16
median delta H in bootstrap population is 46347.12 + 2582.04 - 3527.99
best fit value for delta H is 46229.03+/-2070.94

delta S range is -80.89 to -60.88
median delta S in bootstrap population is -69.46 + 8.57 - 11.44
best fit value for delta S is -69.80+/-6.84
</pre></div>
</div>
<img alt="_images/d66d41774a73e128dab09c4158de7fffa0f65b0198e0e48e4a103d2ef13207ed.png" src="_images/d66d41774a73e128dab09c4158de7fffa0f65b0198e0e48e4a103d2ef13207ed.png" />
</div>
</div>
<div class="section" id="checking-the-smoothness">
<h3>Checking the Smoothness<a class="headerlink" href="#checking-the-smoothness" title="Permalink to this headline">#</a></h3>
<p>How is our distribution of results? Does it approach a random normal distribution? Let us see.</p>
<p>We observe that the distribution is more evenly spread (smoother) and the values follow a curve that resemble a gaussian distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">median</span> <span class="o">=</span> <span class="n">median_dS</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">dS</span>
<span class="n">values</span> <span class="o">=</span> <span class="s2">&quot;dS_list&quot;</span>
<span class="n">ylimits</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span><span class="p">]</span>

<span class="n">y1</span> <span class="o">=</span> <span class="n">bs_smooth</span><span class="p">[</span><span class="n">values</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">y1_sorted</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">y1</span><span class="p">))</span>


<span class="c1">#######################################</span>
<span class="c1">### Create plot</span>
<span class="c1">#######################################</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="c1">#style = &quot;S2_classic2.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="n">size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>  

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
<span class="c1">#          title = Title,       </span>
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\Delta S^\ddagger$&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$n$&quot;</span><span class="p">,</span>                
<span class="c1">#          xlim=[0.0030,0.00354],                  </span>
          <span class="n">ylim</span><span class="o">=</span><span class="n">ylimits</span>
       <span class="p">)</span>
<span class="c1">#ax[0].set_xticks([0.0031,0.0033,0.0035])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
<span class="c1">#          title = Title,       </span>
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\Delta S^\ddagger$&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\text{sorted }n$&quot;</span><span class="p">,</span>                
<span class="c1">#          xlim=[0, 0.0036],                  </span>
          <span class="n">ylim</span><span class="o">=</span><span class="n">ylimits</span>
       <span class="p">)</span>
<span class="c1">#ax[1].set_xticks([0,0.001,0.002,0.003])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span> 
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1_sorted</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span>
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">median</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">median</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">n_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span>
<span class="c1">### 68%</span>
<span class="n">percentile68left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
<span class="n">percentile68right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="mi">84</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">n_points</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">percentile68left</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">percentile68right</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">percentile68left</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="s2">&quot;68%&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>



<span class="c1">### 95%</span>
<span class="n">percentile95left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">percentile95right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="mf">97.1</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">percentile95left</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">percentile95right</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">percentile95left</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="s2">&quot;95%&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>


<span class="c1">#######################################</span>
<span class="c1">### Plot gaussin Dist</span>
<span class="c1">#######################################</span>

<span class="n">y_r_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">x1</span><span class="p">:</span>
    <span class="n">y_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>   <span class="c1">### smooth with gaussian error </span>
    <span class="n">y_r_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_r</span><span class="p">)</span>

<span class="n">y_r_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y_r_list</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">#######################################</span>
<span class="c1">### Output plot</span>
<span class="c1">#######################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/Eyring_bootstrap_5.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/57e40beab79c1cc82ad0edba46f0bd228257c53b63de6f4c597274f2fa555959.png" src="_images/57e40beab79c1cc82ad0edba46f0bd228257c53b63de6f4c597274f2fa555959.png" />
</div>
</div>
</div>
</div>
<div class="section" id="plotting-a-confidence-band">
<h2>Plotting a Confidence Band<a class="headerlink" href="#plotting-a-confidence-band" title="Permalink to this headline">#</a></h2>
<p>We have a set of thousands of lines plotted using the slope and intercept from the resampled and smoothed (by Gaussian error) data set. We have determined the confidence interval for the fit parameters and calculated thermodynamic paraters. Now lets plot the region of the plot that contains a band that encompasses the confidence interval for predicted y-values. All we need to do is get the percentile limits for the upper and lower confidence interval at every point that the prediction was calculated and then plot this is a filled area.</p>
<p>Consider the code below for plotting this band.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">################################################################################</span>
<span class="c1">### SMOOTH BOOTSTRAP </span>
<span class="c1">### </span>
<span class="c1">### Adapted from code found in https://stats.stackexchange.com/questions/183230/bootstrapping-confidence-interval-from-a-regression-prediction</span>
<span class="c1">################################################################################</span>

<span class="c1">#######################################</span>
<span class="c1">## Global variables</span>
<span class="c1">#######################################</span>

<span class="n">sigma</span> <span class="o">=</span> <span class="mi">2</span>                 <span class="c1"># Confidence. 1 sigma:68%, 2 sigma:95%, 3 sigma:99$</span>
<span class="n">boot_n</span> <span class="o">=</span> <span class="mi">2000</span>             <span class="c1"># Number of bootstrap resamples</span>

<span class="c1">#######################################</span>
<span class="c1">## Define confidence percentile limits</span>
<span class="c1">#######################################</span>

<span class="n">sigma_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mf">68.3</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mf">95.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mf">99.7</span><span class="p">}</span>      

<span class="n">conf</span> <span class="o">=</span> <span class="n">sigma_dict</span><span class="p">[</span><span class="n">sigma</span><span class="p">]</span>
<span class="n">low_p</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">-</span> <span class="n">conf</span><span class="o">/</span><span class="mi">2</span>
<span class="n">high_p</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">+</span> <span class="n">conf</span><span class="o">/</span><span class="mi">2</span>

<span class="c1">#######################################</span>
<span class="c1">## Set up functions for curve fit and thermodynamic calculations</span>
<span class="c1">#######################################</span>

<span class="k">def</span> <span class="nf">linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">):</span>     <span class="c1"># Linear function for line fitting</span>
    <span class="k">return</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">intercept</span>

<span class="k">def</span> <span class="nf">eyring_calc</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">):</span>   <span class="c1"># Calculate thermodynamic parameters</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">R</span>
    <span class="n">kb</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">k</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">h</span>
    <span class="n">kappa</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="n">dH</span> <span class="o">=</span> <span class="o">-</span><span class="n">slope</span> <span class="o">*</span> <span class="n">R</span>
    <span class="n">dS</span> <span class="o">=</span> <span class="p">(</span><span class="n">intercept</span> <span class="o">-</span> <span class="n">unp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">kb</span><span class="o">/</span><span class="n">h</span><span class="p">))</span> <span class="o">*</span> <span class="n">R</span>
    <span class="k">return</span> <span class="n">dH</span><span class="p">,</span> <span class="n">dS</span>

<span class="c1">#######################################</span>
<span class="c1">## Bootstrap - Calculate a list of line fits for resampled data sets.</span>
<span class="c1">#######################################</span>

<span class="n">slope_list</span> <span class="o">=</span> <span class="p">[]</span>               <span class="c1"># A list of slopes from each iteration of bootstrap</span>
<span class="n">intercept_list</span> <span class="o">=</span> <span class="p">[]</span>           <span class="c1"># A list of intercepts</span>

<span class="n">dS_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dH_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">x_for_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>   <span class="c1"># Array of x values </span>
<span class="n">x0_for_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>          <span class="c1"># Array of x values starting at zero</span>

<span class="n">y_list</span> <span class="o">=</span> <span class="p">[]</span>                   <span class="c1"># A list of predicted values at each data point</span>
<span class="n">y_for_ci</span> <span class="o">=</span> <span class="p">[]</span>                 <span class="c1"># A list of sets of predicted values at each x point                     </span>
<span class="n">y0_for_ci</span> <span class="o">=</span> <span class="p">[]</span>                <span class="c1"># A list of sets of predicted values at each x0 point</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boot_n</span><span class="p">):</span>
    <span class="n">pick</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>     <span class="c1"># Random list of data points to pick</span>

    <span class="n">x_s</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">pick</span><span class="p">]</span>             <span class="c1"># Get x and y values from random pick</span>
    <span class="n">y_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">pick</span><span class="p">],</span> <span class="n">y_err</span><span class="p">[</span><span class="n">pick</span><span class="p">])</span>   <span class="c1">### smooth with gaussian error </span>
    <span class="n">y_err_s</span> <span class="o">=</span> <span class="n">y_err</span><span class="p">[</span><span class="n">pick</span><span class="p">]</span>

    <span class="n">popt</span><span class="p">,</span><span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">linear</span><span class="p">,</span> <span class="n">x_s</span><span class="p">,</span> <span class="n">y_s</span><span class="p">)</span>    <span class="c1"># Curve fit the resampled data</span>

    <span class="p">[</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">]</span> <span class="o">=</span> <span class="n">popt</span>
    <span class="n">slope_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span>
    <span class="n">intercept_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">intercept</span><span class="p">)</span>

    <span class="n">dH</span><span class="p">,</span> <span class="n">dS</span> <span class="o">=</span> <span class="n">eyring_calc</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">)</span>
    <span class="n">dH_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dH</span><span class="p">)</span>
    <span class="n">dS_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dS</span><span class="p">)</span>

    <span class="n">y_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">))</span>            <span class="c1"># Predict y at data points and add to list</span>
    <span class="n">y_for_ci</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">linear</span><span class="p">(</span><span class="n">x_for_ci</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">))</span>   <span class="c1"># Predict y along data range and add to list</span>
    <span class="n">y0_for_ci</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">linear</span><span class="p">(</span><span class="n">x0_for_ci</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">))</span> <span class="c1"># Predict y from zero to data range and add to list</span>

<span class="c1"># Convert these lists of arrays to arrays of arrays (a matrix)</span>
<span class="n">y_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_list</span><span class="p">)</span>
<span class="n">y_for_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_for_ci</span><span class="p">)</span>    
<span class="n">y0_for_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y0_for_ci</span><span class="p">)</span>

<span class="c1">### Package up data into a dictionary object (for convenience)</span>

<span class="n">bs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;y_list&quot;</span><span class="p">:</span> <span class="n">y_list</span><span class="p">,</span>
    <span class="s2">&quot;x_for_ci&quot;</span><span class="p">:</span> <span class="n">x_for_ci</span><span class="p">,</span>
    <span class="s2">&quot;y_for_ci&quot;</span><span class="p">:</span> <span class="n">y_for_ci</span><span class="p">,</span>
    <span class="s2">&quot;x0_for_ci&quot;</span><span class="p">:</span> <span class="n">x0_for_ci</span><span class="p">,</span>
    <span class="s2">&quot;y0_for_ci&quot;</span><span class="p">:</span> <span class="n">y0_for_ci</span><span class="p">,</span>
    <span class="s2">&quot;slope_list&quot;</span><span class="p">:</span> <span class="n">slope_list</span><span class="p">,</span>
    <span class="s2">&quot;intercept_list&quot;</span><span class="p">:</span> <span class="n">intercept_list</span><span class="p">,</span>
    <span class="s2">&quot;dH_list&quot;</span><span class="p">:</span> <span class="n">dH_list</span><span class="p">,</span>
    <span class="s2">&quot;dS_list&quot;</span><span class="p">:</span> <span class="n">dS_list</span>
<span class="p">}</span>

<span class="c1">#######################################</span>
<span class="c1">## Traditional Curve Fit for Comparison</span>
<span class="c1">#######################################</span>

<span class="n">popt</span><span class="p">,</span><span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">linear</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>                        <span class="c1"># Final curve fit of original data</span>
                      <span class="n">sigma</span> <span class="o">=</span> <span class="n">y_err</span><span class="p">,</span> <span class="n">absolute_sigma</span><span class="o">=</span><span class="kc">False</span>  <span class="c1"># Include st_devs for y data in calculations</span>
                     <span class="p">)</span>

<span class="c1"># Create new ufloat objects from returned parameters and covariance matrix results</span>
<span class="p">[</span><span class="n">slope_u</span><span class="p">,</span> <span class="n">intercept_u</span><span class="p">]</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">correlated_values</span><span class="p">(</span><span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span><span class="p">)</span>

<span class="c1">#######################################</span>
<span class="c1">### Report</span>
<span class="c1">#######################################</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confidence level = </span><span class="si">{</span><span class="n">conf</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">numbers</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="s2">&quot;slope_list&quot;</span><span class="p">])</span>
<span class="n">top_slope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">high_p</span><span class="p">)</span>
<span class="n">bot_slope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">low_p</span><span class="p">)</span>
<span class="n">median_slope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;slope range is </span><span class="si">{</span><span class="n">top_slope</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">bot_slope</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median slope in bootstrap population is </span><span class="si">{</span><span class="n">median_slope</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">top_slope</span><span class="o">-</span><span class="n">median_slope</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">median_slope</span><span class="o">-</span><span class="n">bot_slope</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;best fit value for slope is </span><span class="si">{</span><span class="n">slope_u</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">numbers</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="s2">&quot;intercept_list&quot;</span><span class="p">])</span>
<span class="n">top_intercept</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">high_p</span><span class="p">)</span>
<span class="n">bot_intercept</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">low_p</span><span class="p">)</span>
<span class="n">median_intercept</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;intercept range is </span><span class="si">{</span><span class="n">top_intercept</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">bot_intercept</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median intercept in bootstrap population is </span><span class="si">{</span><span class="n">median_intercept</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">top_intercept</span><span class="o">-</span><span class="n">median_intercept</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">median_intercept</span><span class="o">-</span><span class="n">bot_intercept</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;best fit value for intercept is </span><span class="si">{</span><span class="n">intercept_u</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">dH</span><span class="p">,</span> <span class="n">dS</span> <span class="o">=</span> <span class="n">eyring_calc</span><span class="p">(</span><span class="n">slope_u</span><span class="p">,</span> <span class="n">intercept_u</span><span class="p">)</span>

<span class="n">numbers</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="s2">&quot;dH_list&quot;</span><span class="p">])</span>
<span class="n">top_dH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">high_p</span><span class="p">)</span>
<span class="n">bot_dH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">low_p</span><span class="p">)</span>
<span class="n">median_dH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;delta H range is </span><span class="si">{</span><span class="n">bot_dH</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">top_dH</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median delta H in bootstrap population is </span><span class="si">{</span><span class="n">median_dH</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">top_dH</span><span class="o">-</span><span class="n">median_dH</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">median_dH</span><span class="o">-</span><span class="n">bot_dH</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;best fit value for delta H is </span><span class="si">{</span><span class="n">dH</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">numbers</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="s2">&quot;dS_list&quot;</span><span class="p">])</span>
<span class="n">top_dS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">high_p</span><span class="p">)</span>
<span class="n">bot_dS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">low_p</span><span class="p">)</span>
<span class="n">median_dS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;delta S range is </span><span class="si">{</span><span class="n">bot_dS</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">top_dS</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median delta S in bootstrap population is </span><span class="si">{</span><span class="n">median_dS</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">top_dS</span><span class="o">-</span><span class="n">median_dS</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">median_dS</span><span class="o">-</span><span class="n">bot_dS</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;best fit value for delta S is </span><span class="si">{</span><span class="n">dS</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>


<span class="c1">#######################################</span>
<span class="c1">### Create plot</span>
<span class="c1">#######################################</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="c1">#style = &quot;S2_classic2.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="n">size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>  

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
<span class="c1">#          title = Title,       </span>
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\ln (k / T)$&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$1/T$&quot;</span><span class="p">,</span>                
<span class="c1">#          xlim=[0.0030,0.00354],                  </span>
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">4.5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
       <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mf">0.0032</span><span class="p">,</span><span class="mf">0.0033</span><span class="p">,</span><span class="mf">0.0034</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
<span class="c1">#          title = Title,       </span>
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\ln (k / T)$&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$1/T$&quot;</span><span class="p">,</span>                
          <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0036</span><span class="p">],</span>                  
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">18</span><span class="p">]</span>
       <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">0.002</span><span class="p">,</span><span class="mf">0.003</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">y_err</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">,</span> 
               <span class="n">ecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> 
            <span class="c1">#   capsize=2, capthick=0.5, </span>
               <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">#######################################</span>
<span class="c1">### Plot Best Fit</span>
<span class="c1">#######################################</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_for_ci</span><span class="p">,</span> <span class="n">linear</span><span class="p">(</span><span class="n">x_for_ci</span><span class="p">,</span> <span class="n">slope_u</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">intercept_u</span><span class="o">.</span><span class="n">n</span><span class="p">),</span> 
           <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x0_for_ci</span><span class="p">,</span> <span class="n">linear</span><span class="p">(</span><span class="n">x0_for_ci</span><span class="p">,</span> <span class="n">slope_u</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">intercept_u</span><span class="o">.</span><span class="n">n</span><span class="p">),</span> 
           <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>


<span class="c1">#######################################</span>
<span class="c1">### Interval</span>
<span class="c1">#######################################</span>
<span class="n">top_y</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">bot_y</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">med_y</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_for_ci</span><span class="p">)):</span>
    <span class="n">top_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y_for_ci</span><span class="p">[:,</span><span class="n">n</span><span class="p">],</span> <span class="n">high_p</span><span class="p">))</span>
    <span class="n">bot_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y_for_ci</span><span class="p">[:,</span><span class="n">n</span><span class="p">],</span> <span class="n">low_p</span><span class="p">))</span>
    <span class="n">med_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y_for_ci</span><span class="p">[:,</span><span class="n">n</span><span class="p">],</span> <span class="mi">50</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_for_ci</span><span class="p">,</span> <span class="n">top_y</span><span class="p">,</span> <span class="n">bot_y</span><span class="p">,</span> 
                   <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                   <span class="n">label</span><span class="o">=</span><span class="s2">&quot;confidence interval&quot;</span><span class="p">)</span>

<span class="c1">#######################################</span>
<span class="c1">### Interval</span>
<span class="c1">#######################################</span>
<span class="n">top_y</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">bot_y</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">med_y</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x0_for_ci</span><span class="p">)):</span>
    <span class="n">top_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y0_for_ci</span><span class="p">[:,</span><span class="n">n</span><span class="p">],</span> <span class="n">high_p</span><span class="p">))</span>
    <span class="n">bot_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y0_for_ci</span><span class="p">[:,</span><span class="n">n</span><span class="p">],</span> <span class="n">low_p</span><span class="p">))</span>
    <span class="n">med_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y0_for_ci</span><span class="p">[:,</span><span class="n">n</span><span class="p">],</span> <span class="mi">50</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x0_for_ci</span><span class="p">,</span> <span class="n">top_y</span><span class="p">,</span> <span class="n">bot_y</span><span class="p">,</span> 
                   <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                   <span class="n">label</span><span class="o">=</span><span class="s2">&quot;confidence interval&quot;</span><span class="p">)</span>
 

<span class="c1">#######################################</span>
<span class="c1">### Output plot</span>
<span class="c1">#######################################</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/Eyring_bootstrap_6.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/3h/d_p2gtjd78g8c7m6c14chsg00000gq/T/ipykernel_41161/3313734404.py:65: OptimizeWarning: Covariance of the parameters could not be estimated
  popt,pcov = curve_fit(linear, x_s, y_s)    # Curve fit the resampled data
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Confidence level = 95.5%

slope range is -4714.5 to -6289.5
median slope in bootstrap population is -5572.3 + 857.8 - 717.2
best fit value for slope is -5545.9+/-277.8

intercept range is 17.80 to 12.60
median intercept in bootstrap population is 15.40 + 2.40 - 2.81
best fit value for intercept is 15.31+/-0.92

delta H range is 39198.61 to 52293.96
median delta H in bootstrap population is 46331.02 + 5962.94 - 7132.41
best fit value for delta H is 46110.87+/-2309.56

delta S range is -92.83 to -49.53
median delta S in bootstrap population is -69.47 + 19.94 - 23.36
best fit value for delta S is -70.24+/-7.63
</pre></div>
</div>
<img alt="_images/1681525610edba4c563b94116e502c97d8b0421403a6e2229d63c498fe851ff6.png" src="_images/1681525610edba4c563b94116e502c97d8b0421403a6e2229d63c498fe851ff6.png" />
</div>
</div>
</div>
<div class="section" id="bonus-gaussian-error">
<h2>Bonus: Gaussian Error<a class="headerlink" href="#bonus-gaussian-error" title="Permalink to this headline">#</a></h2>
<p>The smooth bootstrap above used a function that applied Guassian error to our data point. We can visualize the distrubution of Guassian error using a “normal distribution” function. Consider the code below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">y_data</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x12be705d0&gt;]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="bonus-bootstrap-step-by-step">
<h2>Bonus: Bootstrap Step by Step<a class="headerlink" href="#bonus-bootstrap-step-by-step" title="Permalink to this headline">#</a></h2>
<p>below is code that makes a plot of twelve example boostrap runs. In each a different set of the five data points, randomly chose with replacement, is presented. Imagine that this was the first twelve plots in the 2000 we ran for each bootstrap above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################</span>
<span class="c1">## Set up functions for curve fit and thermodynamic calculations</span>
<span class="c1">#######################################</span>

<span class="k">def</span> <span class="nf">linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">):</span>     <span class="c1"># Linear function for line fitting</span>
    <span class="k">return</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">intercept</span>

<span class="k">def</span> <span class="nf">eyring_calc</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">):</span>   <span class="c1"># Calculate thermodynamic parameters</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">R</span>
    <span class="n">kb</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">k</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">h</span>
    <span class="n">kappa</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="n">dH</span> <span class="o">=</span> <span class="o">-</span><span class="n">slope</span> <span class="o">*</span> <span class="n">R</span>
    <span class="n">dS</span> <span class="o">=</span> <span class="p">(</span><span class="n">intercept</span> <span class="o">-</span> <span class="n">unp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">kb</span><span class="o">/</span><span class="n">h</span><span class="p">))</span> <span class="o">*</span> <span class="n">R</span>
    <span class="k">return</span> <span class="n">dH</span><span class="p">,</span> <span class="n">dS</span>

<span class="k">def</span> <span class="nf">contact_sheet</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y_err</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
            <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">,</span><span class="s2">&quot;3&quot;</span><span class="p">,</span><span class="s2">&quot;4&quot;</span><span class="p">,</span><span class="s2">&quot;5&quot;</span><span class="p">,</span><span class="s2">&quot;6&quot;</span><span class="p">,</span><span class="s2">&quot;7&quot;</span><span class="p">,</span><span class="s2">&quot;8&quot;</span><span class="p">,</span><span class="s2">&quot;9&quot;</span><span class="p">,</span><span class="s2">&quot;10&quot;</span><span class="p">,</span><span class="s2">&quot;11&quot;</span><span class="p">,</span><span class="s2">&quot;12&quot;</span><span class="p">,</span><span class="s2">&quot;13&quot;</span><span class="p">,</span><span class="s2">&quot;14&quot;</span><span class="p">,</span><span class="s2">&quot;15&quot;</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Plots 12 plots, one for each column of plate</span>
<span class="sd">    </span>
<span class="sd">    Will produce a &#39;contact sheet&#39; of plots, one for each plat column</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    ---------</span>
<span class="sd">    data_root_name: string</span>
<span class="sd">        The file root name. Column and row labels will be added.</span>
<span class="sd">    columns, row: lists</span>
<span class="sd">        These are the lists of names for the columns and rows. Will be appended</span>
<span class="sd">        to data_root_name to access the individual data files.</span>
<span class="sd">    enzymes: list</span>
<span class="sd">        The names of the enzymes (or other note) in each column.</span>
<span class="sd">        Will be printed on each plot for corresponding column</span>
<span class="sd">    Returns: </span>
<span class="sd">    -------</span>

<span class="sd">    Nul</span>

<span class="sd">    Will output the 3 column X 4 row plot of all data sets in the plate</span>
<span class="sd">    and save the plot as a pdf file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1">### set counter</span>
    <span class="k">for</span> <span class="n">plot_name</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
        
        <span class="n">pick</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>     <span class="c1"># Random list of data points to pick</span>
    
        <span class="n">x_s</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">pick</span><span class="p">]</span>             <span class="c1"># Get x and y values from random pick</span>
        <span class="n">y_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">pick</span><span class="p">],</span> <span class="n">y_err</span><span class="p">[</span><span class="n">pick</span><span class="p">])</span>   <span class="c1">### smooth with gaussian error </span>
        <span class="n">y_err_s</span> <span class="o">=</span> <span class="n">y_err</span><span class="p">[</span><span class="n">pick</span><span class="p">]</span>
    
        <span class="n">popt</span><span class="p">,</span><span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">linear</span><span class="p">,</span> <span class="n">x_s</span><span class="p">,</span> <span class="n">y_s</span><span class="p">)</span>    <span class="c1"># Curve fit the resampled data</span>
    
        <span class="p">[</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">]</span> <span class="o">=</span> <span class="n">popt</span>



        <span class="n">plot_row</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">5</span>   <span class="c1">### use counter to get column and row</span>
        <span class="n">plot_col</span> <span class="o">=</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">5</span>
    
        <span class="n">ax</span><span class="p">[</span><span class="n">plot_row</span><span class="p">][</span><span class="n">plot_col</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                    <span class="n">xlabel</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                    <span class="n">ylabel</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="mf">.00315</span><span class="p">,</span> <span class="mf">.00345</span><span class="p">],</span>                  
                    <span class="n">ylim</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">3.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.3</span><span class="p">])</span>
        

        <span class="c1">### Column 0 gets y-axis label and ticks.</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">plot_row</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\ln{k/T}$&quot;</span><span class="p">)</span>
<span class="c1">#        ax[plot_row][0].set_yticks([-2.5,-3.0,-3.5])</span>
        <span class="c1">### Columns 1 &amp; 2 get no y-axis ticks.</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">plot_row</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">plot_row</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">plot_row</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">plot_row</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    
        <span class="c1">### Row 3 (bottom) gets x-axis label and ticks.</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">plot_col</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$1/T$&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">plot_col</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
        <span class="c1">### Other rows get no x-axis ticks.</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">plot_col</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    
<span class="c1">#        ax[plot_row][plot_col].text(.00317, -2.25, &quot;Sample &quot;+str(plot_name)) </span>

        <span class="n">ax</span><span class="p">[</span><span class="n">plot_row</span><span class="p">][</span><span class="n">plot_col</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">),</span> 
                                    <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> 
                                    <span class="n">linewidth</span><span class="o">=</span><span class="s1">&#39;0.3&#39;</span><span class="p">,</span> 
                                    <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> 
                                    <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">plot_row</span><span class="p">][</span><span class="n">plot_col</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_s</span><span class="p">,</span> <span class="n">y_s</span><span class="p">,</span> 
                                       <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> 
                                       <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
                                       <span class="n">edgecolors</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                       <span class="n">linewidths</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> 
                                       <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> 
                                       <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">plot_row</span><span class="p">][</span><span class="n">plot_col</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_s</span><span class="p">,</span> <span class="n">y_s</span><span class="p">,</span> 
                                       <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> 
                                       <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> 
                                       <span class="n">edgecolors</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                       <span class="n">linewidths</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> 
                                       <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                                       <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1">### end of for row_name in row_name_list:</span>

        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>    <span class="c1">### increment counter</span>
    <span class="c1">### end of for lane_name in lane_name_list:</span>

    <span class="k">return</span><span class="p">()</span>


<span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>      <span class="c1">### switch off interactive display of plots. plt.show() needed to display a plot now</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>     <span class="c1">### resets the plot defaults so we always start in the same place</span>
<span class="k">if</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">location_styles</span> <span class="o">+</span> <span class="s2">&quot;tufte.mplstyle&quot;</span><span class="p">)</span>


<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>                  <span class="c1">### Make ten sets of bootstrap examples</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
                           <span class="n">ncols</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> 
                           <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span> 
                        <span class="c1">#   sharex=True, </span>
                        <span class="c1">#   sharey=True</span>
                           <span class="p">)</span>  
    
    <span class="n">temp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">293</span><span class="p">,</span> <span class="mi">298</span><span class="p">,</span> <span class="mi">303</span><span class="p">,</span> <span class="mi">308</span><span class="p">,</span> <span class="mi">313</span><span class="p">]</span>       <span class="c1"># list of temperatures</span>
    <span class="n">k_obs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.6</span><span class="p">,</span> <span class="mf">11.7</span><span class="p">,</span> <span class="mf">15.2</span><span class="p">,</span> <span class="mf">21.3</span><span class="p">,</span> <span class="mf">27.8</span><span class="p">]</span>  <span class="c1"># list of observe rate constants (s^-1)</span>
    <span class="n">k_obs_err</span><span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span> <span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>  <span class="c1"># list of standard deviations for data</span>
    
    <span class="c1">### Convert lists to numpy arrays (enables numpy math tools with these lists)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
    <span class="n">k_obs</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">uarray</span><span class="p">(</span><span class="n">k_obs</span><span class="p">,</span> <span class="n">k_obs_err</span><span class="p">)</span>   <span class="c1"># make an array of ufloat values</span>
    
    <span class="c1">### Calculations for Erying plot axes</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">temp</span>
    <span class="n">y_u</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">k_obs</span><span class="o">/</span><span class="n">temp</span><span class="p">)</span>   <span class="c1"># y_u is now an array of ufloats</span>
    
    <span class="n">y</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">y_u</span><span class="p">)</span> <span class="c1"># extract arrays of nominal values and errors</span>
    <span class="n">y_err</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">std_devs</span><span class="p">(</span><span class="n">y_u</span><span class="p">)</span>   <span class="c1"># because curve_fit can handle ufloats</span>
    
    <span class="n">contact_sheet</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y_err</span><span class="p">)</span>
    
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># otherwise the right y-label is slightly clipped</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_contact_sheet&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;.pdf&quot;</span><span class="p">)</span>     <span class="c1">### export the plot as this</span>
    <span class="c1">#plt.show()                 ### display the plot in this notebook</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Plot saved as plots/plot_contact_sheet.pdf&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Plot saved as plots/plot_contact_sheet.pdf
Plot saved as plots/plot_contact_sheet.pdf
Plot saved as plots/plot_contact_sheet.pdf
Plot saved as plots/plot_contact_sheet.pdf
Plot saved as plots/plot_contact_sheet.pdf
Plot saved as plots/plot_contact_sheet.pdf
Plot saved as plots/plot_contact_sheet.pdf
Plot saved as plots/plot_contact_sheet.pdf
Plot saved as plots/plot_contact_sheet.pdf
Plot saved as plots/plot_contact_sheet.pdf
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="03D-Eyring_Exercises_4_pandas.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Part 3D: Reading Data</p>
      </div>
    </a>
    <a class="right-next"
       href="04-Styling.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Part 4: Styling with Style Sheets</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-data-set">The Data Set</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-quick-bootstrap">A Quick Bootstrap</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#styling-the-plot">Styling the Plot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-bootstrap">The Bootstrap</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-bootstrap-runs">Plotting the Bootstrap Runs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-the-distribution">Checking the Distribution</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smooth-bootstrap">Smooth Bootstrap</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-the-smoothness">Checking the Smoothness</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-a-confidence-band">Plotting a Confidence Band</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-gaussian-error">Bonus: Gaussian Error</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-bootstrap-step-by-step">Bonus: Bootstrap Step by Step</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Barry Linkletter
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>